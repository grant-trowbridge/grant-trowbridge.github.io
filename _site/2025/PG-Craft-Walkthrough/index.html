<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="shortcut icon" href="/images/favicon.png " type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Grant Trowbridge's Blog - Proving Grounds Craft: Walkthrough</title>
  <meta name="description" content="Today&#39;s CTF blog will cover Proving Grounds machine Craft.">
  <link rel="stylesheet" href="/css/main.css ">
  <link rel="alternate" type="application/rss+xml" title="Grant Trowbridge's Blog" href="http://localhost:4000/feed.xml
    " />
</head>

<body>
  <div id="header">
  <div id="header__content">
    <div id="header__info">
      <h1><a href="/">Grant Trowbridge's Blog</a></h1>
      <p>Cybersecurity blog covering security-related topics, CTFs, and signals
</p>
      <img src="/images/avatar.png" alt="avatar">
    </div>
    <ul id="header__nav">
      <li><a href="/" class="">Main</a>
      </li>
      <li><a href="/about" class="">whoami</a></li>
      <li><a href="/archive" class="">Archive</a></li>
    </ul>
  </div>
</div>
  <div id="content">
    <div id="content__column">
      <div id="single">
  <h2 class="single__title">Proving Grounds Craft: Walkthrough</h2>
  <span class="single__date">Jul 28, 2025</span> 
  <article class="single__article">
  <p>Today&#39;s CTF blog will cover Proving Grounds machine Craft.</p>

<h1>Enumeration</h1>

<p>I&#39;ll start by kicking off an <code>nmap</code> scan of all 65535 TCP ports to see what we&#39;re working with.</p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Nmap-Tcp-Scan-1.png" alt="nmap TCP Scan 1"></p>

<p>It looks like the target is blocking ICMP packets. Not a problem, <code>nmap</code> can be instructed to skip host discovery using the <code>-Pn</code> flag. Let&#39;s try that again.</p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Nmap-Tcp-Scan-2.png" alt="nmap TCP Scan 2"></p>

<p>The scan only returned port 80, which is serving some sort of HTTP service. Let&#39;s gather more information about this service with an aggressive scan.</p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Nmap-Tcp-Scan-3.png" alt="nmap TCP Scan 3"></p>

<p>The scan didn&#39;t return anything too noteworthy, but I&#39;ll jot down the service names and versions to research later. As a side note, make sure to enumerate UDP ports as well. In this particular case, the scan didn&#39;t return any ports.</p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Nmap-Udp-Scan.png" alt="nmap UDP Scan"></p>

<h2>Web Application Enumeration</h2>

<p>HTTP(S) services call for directory/file brute forcing. I&#39;ll use the <code>gobuster</code> <strong>dir</strong> mode and provide the <code>-x</code> flag to specify the file extensions I want to test. It doesn&#39;t take long to find some interesting stuff like <code>/uploads</code> and <code>/upload.php</code>.</p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Gobuster-Scan.png" alt="gobuster Scan"></p>

<p>I&#39;ll browse out to the root directory in Firefox to see what the rendered page looks like. Google Translate wasn&#39;t any help, but it&#39;s safe to assume that this is some sort of business website. Further down the page, I found an upload feature for submitting resumes!</p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Craft-Landing-Page.png" alt="Craft Landing Page"></p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Craft-Upload.png" alt="Craft Upload"></p>

<p>To test the upload function, I will provide a simple text file to see what happens. It appears this <code>upload.php</code> file checks the file extension to ensure only <code>.odt</code> files are allowed.</p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Craft-Upload-Test-1.png" alt="Craft Upload Test 1"></p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Craft-Upload-Test-2.png" alt="Craft Upload Test 2"></p>

<p>Now it&#39;s time to enlist the help of BurpSuite to modify the POST request. I spent a lot of time messing with different PHP file extensions and some null byte shenanigans, but nothing worked. If I want to upload a file to this web server, it must have a <code>.odt</code> file extension.</p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Craft-Upload-BurpSuite.png" alt="Craft Upload BurpSuite"></p>

<h1>.odt File Research &amp; Creation</h1>

<p>Having created malicous Office 365 macros in the past, I assume LibreOffice may have similar functions that can be abused. I did some Googling and found this <a href="https://medium.com/@akshay__0/initial-access-via-malicious-odt-macro-ac7f5d15796d">Medium article</a> detailing malicious ODT file macros. The syntax for this macro is targeted for Linux machines, so the script itself is not useful to me, but the instructions for creating a LibreOffice macro are still of value. Knowing this, I searched for Microsoft VBA Macro reverse shell scripts and found another <a href="https://medium.com/@mavrogiannispan/phishing-2-0-9f49654de4a6">Medium Article</a> written by Mavrogiannis Panagiotis that contained proper syntax for Windows targets. First, I need to create a malicious document in LibreOffice. Select <strong>File &gt; New &gt; Text Document</strong> to create a new file. Once the document window opens, navigate to <strong>File &gt; Save As..</strong> and save the file, ensuring the <code>.odt</code> extension is specified.</p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Odt-Step-1.png" alt="Odt Step 1"></p>

<p><img src="/assets/img/PG-Craft-Walkthrough_Odt-Step-2.png" alt="Odt Step 2"></p>

  </article>
</div>
    </div>
  </div>
    <div id="footer">
  Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> Â· <a href="https://github.com/ifedyukin/Mekyll">Mekyll</a> theme <br>
</div>

</body>
</html>