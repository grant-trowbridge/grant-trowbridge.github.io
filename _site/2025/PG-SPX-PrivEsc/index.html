<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <link rel="shortcut icon" href="/images/favicon.png " type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Grant Trowbridge's Blog - Proving Grounds SPX: Privilege Escalation</title>
  <meta name="description" content="As I continue to progress through TJ Null&#39;s OSCP PWK V3 list, I wanted to cover a particular machine that had a very unique privilege escalation vulnerab...">
  <link rel="stylesheet" href="/css/main.css ">
  <link rel="alternate" type="application/rss+xml" title="Grant Trowbridge's Blog" href="http://localhost:4000/feed.xml
    " />
</head>

<body>
  <div id="header">
  <div id="header__content">
    <div id="header__info">
      <h1><a href="/">Grant Trowbridge's Blog</a></h1>
      <p>Cybersecurity blog covering security-related topics, CTFs, and signals
</p>
      <img src="/images/avatar.png" alt="avatar">
    </div>
    <ul id="header__nav">
      <li><a href="/" class="">Main</a>
      </li>
      <li><a href="/about" class="">About</a></li>
      <li><a href="/archive" class="">Archive</a></li>
    </ul>
  </div>
</div>
  <div id="content">
    <div id="content__column">
      <div id="single">
  <h2 class="single__title">Proving Grounds SPX: Privilege Escalation</h2>
  <span class="single__date">Jul 2, 2025</span> 
  <article class="single__article">
  <p>As I continue to progress through <a href="https://docs.google.com/spreadsheets/u/1/d/1dwSMIAPIam0PuRBkCiDI88pU3yzrqqHkDtBngUHNCw8/htmlview">TJ Null&#39;s OSCP PWK V3 list</a>, I wanted to cover a particular machine that had a very unique privilege escalation vulnerability. This machine is given the name SPX. I&#39;ll skip over initial access for the sake of brevity and limiting spoilers.</p>

<p>Speaking of spoilers, if you plan on completing this machine and don&#39;t want answers given away, DO NOT PROCEED!</p>

<h1>Identifying the Vulnerability</h1>

<p>After gaining your initial foothold, and switching to another user with compromised credentials, your immediate thought should be:</p>

<p><em>what privileges do I have in this new user context?</em> </p>

<p>The answer? A sudo command for the <code>make</code> binary:</p>

<p><img src="/assets/img/PG-SPX-PrivEsc_Sudo-Cmd.png" alt="profiler sudo privileges"></p>

<h2>Research</h2>

<p>Anytime you come across a specific binary with special permissions (<code>sudo</code> in this case), always consult the <a href="https://gtfobins.github.io/gtfobins/make/#sudo">GTFOBins</a> GitHub Pages site.</p>

<p>Initially, it looks like we have an easy win here, but we do not have access to the <code>-s</code> and <code>--eval</code> flags shown in the example code snippet. Remember, the whitelisted command from the <code>sudo -l</code> output was <code>/usr/bin/make install -C /home/profiler/php-spx</code>:</p>

<p><img src="/assets/img/PG-SPX-PrivEsc_Make-GTFOBin.png" alt="GTFOBin Research"></p>

<p>I&#39;ll be honest, I was stumped on this problem for a good hour or so. I decided to thoroughly enumerate the rest of the system. I was convinced I missed something somewhere. Eventually, I did realize that the <code>sudo</code> permission for this new user was the obvious privilege escalation vulnerability. It was my only direct access to command execution as <em>root</em>.</p>

<h3>Even More Research</h3>

  </article>
</div>
    </div>
  </div>
    <div id="footer">
  Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> Â· <a href="https://github.com/ifedyukin/Mekyll">Mekyll</a> theme <br>
</div>

</body>
</html>